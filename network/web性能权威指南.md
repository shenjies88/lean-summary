## 性能的关键

- 延迟和带宽
- 延迟占绝大部分比重

## TSL认证

- 先进行TCP的三次握手
- 客户端生成随机数，通知服务端自身对TSL的支持情况，包括算法、版本、加密套件、TSL选项等
- 服务端生成随机数，选定加密套件，把自己的公钥用证书签名传送给客户端
- 客户端对证书进行验证，通过后，用服务端的公钥加密自己的“对称密钥”传送给服务端
- 双方用“对称密钥”通信

## HTTP2.0

由流、消息、帧组成

- 在一个TCP链接上，有多个并行双向传输消息的流
- 一个消息是逻辑消息的实体
- 一个消息由多个帧组成，帧可以乱序，帧中带有恢复顺序的信息

一个来源只有一个链接

请求拥有优先级

流量控制

- 基于每一条进行控制

服务器推送

首部压缩

- 客户端及服务端存储并更新一个首部健值对表，不发送冗余信息

## WebSocket

使用自定义的二进制分帧把消息进行拆分

成功的WebSocket握手必须是客户端发送协议版本和自动生成的挑战值，服务器必须返回101HTTP响应码和散列形式的挑战答案，确认选择的协议版本

- 客户端必须发送`Sec-WebSocket-Version`和`Sec-WebSocket-Key`
- 服务器必须返回`Sec-WebSocket-Accept`确认协议
- 客户端可以通过`Sec-WebSocket-Protocol`发送应用子协议列表
- 服务器必须选择一个子协议并通过`Sec-WebSocket-Protocol`返回协议名；如果服务器不支持任何一个协议，连接断开
- 客户端可以通过`Sec-WebSocket-Extensions`发送协议扩展
- 服务器可以通过`Sec-WebSocket-Extensions`确认一或多个扩展；如果服务器没有返回扩展，则链接不支持扩展

